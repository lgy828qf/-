<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title></title>
</head>

<body>
    <script type="text/javascript">
        //整体框架
        let frame = document.createElement("div");
        frame.style.zIndex = 999996;
        frame.id = "cardPage";
        frame.style.position = "fixed";
        frame.style.left = "20px";
        frame.style.top = "40px";
        frame.style.width = "270px";
        frame.style.height = "330px";
        frame.style.backgroundImage = "linear-gradient(to right, red, orange)";

        let information = document.createElement("h3");
        information.innerHTML = "⚡启航护肝小助手⚡\n  ";
        information.style.display = "block";
        information.style.margin = "1px auto";
        information.style.marginTop = "5px"
        information.style.width = "250px";
        information.style.fontSize = "18px";
        information.style.fontWeight = "bold"
        information.style.textAlign = "center";
        frame.appendChild(information);

        let capsuleDiv = document.createElement("div");
        capsuleDiv.style.display = 'flex'
        capsuleDiv.style.alignItems = 'center'
        capsuleDiv.style.justifyContent = 'space-evenly'
        capsuleDiv.style.margin = '10px 0px'

        let capsuleSpen = document.createElement('spen');
        let capsuleLabel = document.createElement('label');
        capsuleLabel.innerHTML = '胶囊：';
        capsuleLabel.style.fontSize = "14px";
        capsuleSpen.appendChild(capsuleLabel)

        let capsuleSelect = document.createElement('select')
        capsuleSelect.setAttribute('id', 'capsuleSelectId')
        capsuleSelect.style.border = '1px solid #ccc'
        capsuleSelect.style.borderRadius = '5px'
        capsuleSelect.style.fontSize = '14px'
        let capsuleOption1 = document.createElement('option')
        capsuleOption1.value = '4001'
        capsuleOption1.text = '初级'
        let capsuleOption2 = document.createElement('option')
        capsuleOption2.value = '4002'
        capsuleOption2.text = '中级'
        let capsuleOption3 = document.createElement('option')
        capsuleOption3.value = '4003'
        capsuleOption3.text = '高级'
        capsuleSelect.appendChild(capsuleOption1)
        capsuleSelect.appendChild(capsuleOption2)
        capsuleSelect.appendChild(capsuleOption3)
        capsuleSpen.appendChild(capsuleSelect)

        capsuleDiv.appendChild(capsuleSpen)

        let frequencySpen = document.createElement('spen');
        let frequencyLabel = document.createElement('label');
        frequencyLabel.innerHTML = '次数：';
        frequencyLabel.style.fontSize = "14px";
        var frequencyInput = document.createElement("input");
        frequencyInput.id = 'frequency';
        frequencyInput.style.width = "20px";
        frequencyInput.style.height = "14px";
        frequencySpen.appendChild(frequencyLabel);
        frequencySpen.appendChild(frequencyInput);
        capsuleDiv.appendChild(frequencySpen);

        let roundSpen = document.createElement('spen');
        let roundLabel = document.createElement('label');
        roundLabel.innerHTML = '回合：';
        roundLabel.style.fontSize = "14px";
        var roundInput = document.createElement("input");
        roundInput.id = 'round';
        roundInput.value = '1';
        roundInput.style.width = "20px";
        roundInput.style.height = "14px";
        roundSpen.appendChild(roundLabel);
        roundSpen.appendChild(roundInput);
        capsuleDiv.appendChild(roundSpen);

        frame.appendChild(capsuleDiv)

        var produceLogPanel = 0
        var tttt

        let buttonDiv1 = document.createElement("div");
        buttonDiv1.style.display = 'flex'
        buttonDiv1.style.alignItems = 'center'
        buttonDiv1.style.justifyContent = 'space-evenly'
        buttonDiv1.style.margin = '10px 0px'

        var drift = document.createElement("button");
        drift.innerHTML = "迷航";
        drift.style.margin = "4px";
        drift.style.width = "45px";
        drift.style.height = "30px";
        // 在点击按钮时输出日志到文本框中
        drift.onclick = async function () {
            await starTrek()
        };
        buttonDiv1.appendChild(drift);

        var resource = document.createElement("button");
        resource.innerHTML = "资源";
        resource.style.margin = "4px";
        resource.style.width = "45px";
        resource.style.height = "30px";
        resource.onclick = async function () {
            if (rewrite == 0) {
                showToast("请先开启监听！");
                return
            }
            try {
                let firTime = UserManager.getInstance().userInfo.defaultTeam[0]
                skillID = PetManager.getInstance().getPetInfoByGetTime(firTime).skills[0];
            } catch (e) {
                let firTime = document.querySelector("iframe").contentWindow.UserManager.getInstance().userInfo.defaultTeam[0]
                skillID = document.querySelector("iframe").contentWindow.PetManager.getInstance().getPetInfoByGetTime(firTime).skills[0];
            }

            writeLog("皮皮星第一层")
            while (true) {
                //查询轮盘
                await sendMsg(1176, { planetId: 1 })
                let reward = ""
                CmdArr.forEach(item => {
                    if (parseInt(Object.keys(item)[0]) == 1176) {
                        reward = JSON.parse(item["1176"]).reward
                    }
                })
                if (reward["1"] == undefined) {
                    writeLog("皮皮星①第1次奖励!")
                }
                else if (reward["1"] < 10) {
                    writeLog("皮皮星①第" + reward["1"] + "次奖励!")
                } else {
                    writeLog("皮皮星①完成！")
                    CmdArr = []
                    break
                }

                await getObjs(20001, 109, 1)
                await wait(200)
                CmdArr = []
            }
            await wait(200)

            writeLog("皮皮第二层")
            while (true) {
                //查询轮盘
                await sendMsg(1176, { planetId: 1 })
                let reward = ""
                CmdArr.forEach(item => {
                    if (parseInt(Object.keys(item)[0]) == 1176) {
                        reward = JSON.parse(item["1176"]).reward
                    }
                })
                if (reward["2"] == undefined) {
                    writeLog("皮皮星②第1次奖励!")
                }
                else if (reward["2"] < 10) {
                    writeLog("皮皮星②第" + reward["2"] + "次奖励!")
                } else {
                    writeLog("皮皮星②完成!")
                    CmdArr = []
                    break
                }
                await wait(200)

                await getObjs(20002, 87, 2)
                CmdArr = []
            }
            await wait(200)
            writeLog("皮皮第三层")
            while (true) {
                //查询轮盘
                await sendMsg(1176, { planetId: 1 })
                let reward = ""
                CmdArr.forEach(item => {
                    if (parseInt(Object.keys(item)[0]) == 1176) {
                        reward = JSON.parse(item["1176"]).reward
                    }
                })

                if (reward["3"] < 5) {
                    let oneC = isNaN(parseInt(reward["3"])) ? 0 : parseInt(reward["3"])
                    let twoC = isNaN(parseInt(reward["4"])) ? 0 : parseInt(reward["4"])
                    writeLog("皮皮星③第" + (oneC + twoC) + "次奖励!")
                    await getObjs(20003, 29, 3)

                } else if (reward["4"] < 5) {
                    let oneC = isNaN(parseInt(reward["3"])) ? 0 : parseInt(reward["3"])
                    let twoC = isNaN(parseInt(reward["4"])) ? 0 : parseInt(reward["4"])
                    writeLog("皮皮星③第" + (oneC + twoC) + "次奖励!")

                    await getObjs(20003, 29, 4)
                } else if (reward["3"] == undefined) {
                    await getObjs(20003, 29, 3)
                } else if (reward["4"] == undefined) {
                    await getObjs(20003, 29, 4)
                } else {
                    writeLog("皮皮星③完成!")
                    CmdArr = []
                    await wait(200)
                    break
                }

                CmdArr = []
            }

            await wait(200)
            writeLog("水星第一层")
            while (true) {
                CmdArr = []
                //查询轮盘
                await sendMsg(1176, { planetId: 2 })
                let reward = ""
                CmdArr.forEach(item => {
                    if (parseInt(Object.keys(item)[0]) == 1176) {
                        reward = JSON.parse(item["1176"]).reward
                    }
                })
                if (reward["9"] == undefined) {
                    writeLog("水星①第1次奖励!")
                } else if (reward["9"] < 20) {
                    writeLog("水星①第" + reward["9"] + "次奖励!")
                } else {
                    writeLog("水星①完成!")
                    CmdArr = []
                    break
                }
                await wait(200)

                await getObjs(20004, 31, 9)
                CmdArr = []
            }

            await wait(200)
            writeLog("水星第二层")
            while (true) {
                CmdArr = []
                //查询轮盘
                await sendMsg(1176, { planetId: 2 })
                let reward = ""
                CmdArr.forEach(item => {
                    if (parseInt(Object.keys(item)[0]) == 1176) {
                        reward = JSON.parse(item["1176"]).reward
                    }
                })
                if (reward["10"] == undefined) {
                    writeLog("水星②第1次奖励!")
                } else if (reward["10"] < 10) {
                    writeLog("水星②第" + reward["10"] + "次奖励!")
                } else {
                    writeLog("水星②完成!")
                    CmdArr = []
                    break
                }
                await wait(200)
                await getObjs(20005, 31, 10)
                CmdArr = []
            }
            await wait(200)
            writeLog("水星第三层")
            while (true) {
                CmdArr = []
                //查询轮盘
                await sendMsg(1176, { planetId: 2 })
                let reward = ""
                CmdArr.forEach(item => {
                    if (parseInt(Object.keys(item)[0]) == 1176) {
                        reward = JSON.parse(item["1176"]).reward
                    }
                })

                if (reward["11"] == undefined) {
                    writeLog("水星③第1次奖励!")
                }

                else if (reward["11"] < 3) {
                    writeLog("水星③第" + reward["11"] + "次奖励!")
                } else {
                    writeLog("水星③完成!")
                    CmdArr = []
                    break
                }

                await getObjs(20006, 31, 11)
                CmdArr = []
                await wait(200)
            }

            await wait(200)
            writeLog("火星第一层")
            while (true) {
                CmdArr = []
                //查询轮盘
                await sendMsg(1176, { planetId: 3 })
                let reward = ""
                CmdArr.forEach(item => {
                    if (parseInt(Object.keys(item)[0]) == 1176) {
                        reward = JSON.parse(item["1176"]).reward
                    }
                })
                if (reward["12"] == undefined) {
                    writeLog("火星①第1次奖励!")
                } else if (reward["12"] < 10) {
                    writeLog("火星①第" + reward["12"] + "次奖励!")
                } else {
                    writeLog("火星①完成!")
                    CmdArr = []
                    break
                }
                await wait(200)
                await getObjs(20007, 9, 12)
                CmdArr = []
            }

            await wait(200)
            writeLog("火星第二层")
            while (true) {
                CmdArr = []
                //查询轮盘
                await sendMsg(1176, { planetId: 3 })
                let reward = ""
                CmdArr.forEach(item => {
                    if (parseInt(Object.keys(item)[0]) == 1176) {
                        reward = JSON.parse(item["1176"]).reward
                    }
                })
                if (reward["13"] == undefined) {
                    writeLog("火星②第1次奖励!")
                } else if (reward["13"] < 20) {
                    writeLog("火星②第" + reward["13"] + "次奖励!")
                } else {
                    writeLog("火星②完成!")
                    CmdArr = []
                    break
                }
                await wait(200)

                await getObjs(20008, 9, 13)
                CmdArr = []
            }

            await wait(200)
            writeLog("火星第三层")
            while (true) {
                CmdArr = []
                //查询轮盘
                await sendMsg(1176, { planetId: 3 })
                let reward = ""
                CmdArr.forEach(item => {
                    if (parseInt(Object.keys(item)[0]) == 1176) {
                        reward = JSON.parse(item["1176"]).reward
                    }
                })
                if (reward["14"] == undefined) {
                    writeLog("火星③第1次奖励!")
                } else if (reward["14"] < 3) {
                    writeLog("火星③第" + reward["14"] + "次奖励!")
                } else {
                    writeLog("火星③第1次奖励!")
                    CmdArr = []
                    break
                }
                await wait(200)

                await getObjs(20009, 9, 14)
                CmdArr = []
            }

            await wait(200)
            writeLog("云霄星第一层")
            while (true) {
                CmdArr = []
                //查询轮盘
                await sendMsg(1176, { planetId: 5 })
                let reward = ""
                CmdArr.forEach(item => {
                    if (parseInt(Object.keys(item)[0]) == 1176) {
                        reward = JSON.parse(item["1176"]).reward
                    }
                })
                if (reward["33"] == undefined) {
                    writeLog("云霄星①第1次奖励!")
                } else if (reward["33"] < 20) {
                    writeLog("云霄星①第" + reward["33"] + "次奖励!")
                } else {
                    writeLog("云霄星完成!")
                    CmdArr = []
                    break
                }
                await wait(200)
                await getObjs(20015, 10, 33)
                CmdArr = []
            }

            await wait(200)
            writeLog("云霄星第二层")
            while (true) {
                CmdArr = []
                //查询轮盘
                await sendMsg(1176, { planetId: 5 })
                let reward = ""
                CmdArr.forEach(item => {
                    if (parseInt(Object.keys(item)[0]) == 1176) {
                        reward = JSON.parse(item["1176"]).reward
                    }
                })
                if (reward["34"] == undefined) {
                    writeLog("云霄星②第1次奖励!")
                } else if (reward["34"] < 10) {
                    writeLog("云霄星②第" + reward["34"] + "次奖励!")
                } else {
                    writeLog("云霄星②完成!")
                    CmdArr = []
                    break
                }
                await wait(200)
                await getObjs(20016, 9, 34)
                CmdArr = []
            }

            await wait(200)
            writeLog("云霄星第三层")
            while (true) {
                CmdArr = []
                //查询轮盘
                await sendMsg(1176, { planetId: 5 })
                let reward = ""
                CmdArr.forEach(item => {
                    if (parseInt(Object.keys(item)[0]) == 1176) {
                        reward = JSON.parse(item["1176"]).reward
                    }
                })
                if (reward["35"] == undefined) {
                    writeLog("云霄星③第1次奖励!")
                } else if (reward["35"] < 5) {
                    writeLog("云霄星③第" + reward["35"] + "次奖励!")
                } else {
                    writeLog("云霄星③完成!")
                    CmdArr = []
                    break
                }
                await wait(200)

                await getObjs(20017, 10, 35)
                CmdArr = []
            }

            await wait(200)
            writeLog("双子阿尔法第一层")
            while (true) {
                CmdArr = []
                //查询轮盘
                await sendMsg(1176, { planetId: 6 })
                let reward = ""
                CmdArr.forEach(item => {
                    if (parseInt(Object.keys(item)[0]) == 1176) {
                        reward = JSON.parse(item["1176"]).reward
                    }
                })
                if (reward["179"] == undefined) {
                    writeLog("双子阿尔法星①第1次奖励!")
                } else if (reward["179"] < 10) {
                    writeLog("双子阿尔法星①第" + reward["179"] + "次奖励!")
                } else {
                    writeLog("双子阿尔法星①完成!")
                    CmdArr = []
                    break
                }

                await getObjs(20018, 9, 179)
                await wait(200)

                CmdArr = []
            }

            await wait(200)
            writeLog("双子阿尔法第二层")
            try {
                var ziyuan1 = document.querySelector("iframe").contentWindow.ItemManager.getInstance().getItemNumById(100194)
            } catch (e) {
                ziyuan1 = ItemManager.getInstance().getItemNumById(100194)
            }
            if (parseInt(ziyuan1) < 3) {
                showToast("没有材料打不了！！")
            } else {
                try {
                    FirgetTime = document.querySelector("iframe").contentWindow.UserManager.getInstance().userInfo.defaultTeam[0]
                    Pet = document.querySelector("iframe").contentWindow.PetManager.getInstance().getPetInfoByGetTime(FirgetTime)
                } catch (e) {
                    FirgetTime = UserManager.getInstance().userInfo.defaultTeam[0]
                    Pet = PetManager.getInstance().getPetInfoByGetTime(FirgetTime)
                }
                while (true) {
                    //查询轮盘
                    await sendMsg(1176, { planetId: 6 })
                    let reward = ""
                    CmdArr.forEach(item => {
                        if (parseInt(Object.keys(item)[0]) == 1176) {
                            reward = JSON.parse(item["1176"]).reward
                        }
                    })
                    if (reward["178"] < 3 || reward["178"] == undefined) {
                        await sendMsg(1172, {
                            "levelId": 178,
                            "battleType": 3
                        })
                        while (1) {
                            if (bossStatus == true) {
                                bossStatus = false
                                break
                            }
                            await wait(100)
                        }
                        await sendSkillToSuccess(Pet.skills[0])
                        writeLog("双子阿尔法星②" + (reward["178"] + 1) + "次奖励!")
                    } else {
                        writeLog("双子阿尔法星②完成！")
                        CmdArr = []
                        break
                    }
                }
                await wait(200)
            }

            writeLog("双子阿尔法第二层")
            while (true) {
                CmdArr = []
                //查询轮盘
                await sendMsg(1176, { planetId: 6 })
                let reward = ""
                CmdArr.forEach(item => {
                    if (parseInt(Object.keys(item)[0]) == 1176) {
                        reward = JSON.parse(item["1176"]).reward
                    }
                })
                if (reward["60"] == undefined) {
                    writeLog("喷泉星②第1次奖励!")
                } else if (reward["60"] < 10) {
                    writeLog("喷泉星②第" + reward["60"] + "次奖励!")
                } else {
                    writeLog("喷泉星②完成!")
                    CmdArr = []
                    break
                }
                await getObjs(20020, 9, 60)
                CmdArr = []
                await wait(200)
            }

            await wait(200)
            writeLog("暗影星第一层")
            while (true) {
                CmdArr = []
                //查询轮盘
                await sendMsg(1176, { planetId: 8 })
                let reward = ""
                CmdArr.forEach(item => {
                    if (parseInt(Object.keys(item)[0]) == 1176) {
                        reward = JSON.parse(item["1176"]).reward
                    }
                })
                if (reward["66"] == undefined) {
                    writeLog("暗影星①第一次奖励!")
                } else if (reward["66"] < 20) {
                    writeLog("暗影星①第" + reward["66"] + "次奖励!")
                } else {
                    writeLog("暗影星①完成!")
                    CmdArr = []
                    break
                }
                await getObjs(20026, 43, 66)
                await wait(200)

                CmdArr = []
            }

            await wait(200)
            writeLog("暗影星第二层")
            try {
                var ziyuan2 = document.querySelector("iframe").contentWindow.ItemManager.getInstance().getItemNumById(100314)
            } catch (e) {
                ziyuan2 = ItemManager.getInstance().getItemNumById(100314)
            }
            if (parseInt(ziyuan2) < 3) {
                showToast("没有材料打不了！！")
            } else {
                var FirgetTime
                var Pet
                try {
                    FirgetTime = document.querySelector("iframe").contentWindow.UserManager.getInstance().userInfo.defaultTeam[0]
                    Pet = document.querySelector("iframe").contentWindow.PetManager.getInstance().getPetInfoByGetTime(FirgetTime)
                } catch (e) {
                    FirgetTime = UserManager.getInstance().userInfo.defaultTeam[0]
                    Pet = PetManager.getInstance().getPetInfoByGetTime(FirgetTime)
                }
                while (true) {
                    //查询轮盘
                    await sendMsg(1176, { planetId: 8 })
                    let reward = ""
                    CmdArr.forEach(item => {
                        if (parseInt(Object.keys(item)[0]) == 1176) {
                            reward = JSON.parse(item["1176"]).reward
                        }
                    })
                    if (reward["233"] < 3 || reward["233"] == undefined) {
                        await sendMsg(1172, {
                            "levelId": 233,
                            "battleType": 3
                        })
                        while (1) {
                            if (bossStatus == true) {
                                bossStatus = false
                                break
                            }
                            await wait(100)
                        }
                        await sendSkillToSuccess(Pet.skills[0])
                        writeLog("拜伦号" + (reward["233"] + 1) + "次奖励!")
                    } else {
                        writeLog("拜伦号②完成！")
                        CmdArr = []
                        break
                    }
                }
                await wait(200)
            }
            console.log("刷资源")
        };
        buttonDiv1.appendChild(resource);

        var monster = document.createElement("button");
        monster.innerHTML = "打怪";
        monster.style.margin = "4px";
        monster.style.width = "45px";
        monster.style.height = "30px";
        monster.onclick = async function () {
            if (rewrite == 0) {
                showToast("请先开启监听！宝贝")
                return
            }
            await fightQiu()
        };
        buttonDiv1.appendChild(monster);

        var hire = document.createElement("button");
        hire.innerHTML = "雇佣";
        hire.style.margin = "4px";
        hire.style.width = "45px";
        hire.style.height = "30px";
        hire.onclick = async function () {
            if (rewrite == 0) {
                showToast("请先开启监听！宝贝")
                return
            }
            SelfUid = userId.value
            console.log(SelfUid)
            let nowSkillId = skillID

            while (1) {
                CmdArr = []
                await sendMsg(10042, {
                    "friendPageNo": 1,
                    "friendPageSize": 1000,
                    "teamPageNo": 1,
                    "teamPageSize": 1000
                })
                let HireArr = []
                CmdArr.forEach(item => {
                    if (parseInt(Object.keys(item)[0]) == 10042) {
                        let teamHireList = JSON.parse(item["10042"]).teamHireList
                        teamHireList.forEach(item0 => {
                            if (item0.userId == parseInt(SelfUid)) {
                                console.log(item0)
                                HireArr.push(item0)
                            }
                        })
                    }
                })

                let doneGet = 0
                for (let index = 0; index < HireArr.length; index++) {
                    if (HireArr[index].petHireTimes < 10) {
                        doneGet = 1
                        writeLog("" + HireArr[index].roleNick + "的第" + (index + 1) + "只精灵,雇佣次数:" + HireArr[index].petHireTimes)
                        let newTeamList = []

                        for (let index = 0; index < myTeam.length; index++) {
                            if (myTeam[index].indexOf("_") != -1) {
                                break
                            } else {
                                newTeamList.push(myTeam[index])
                            }
                        }

                        newTeamList.push(SelfUid + "_" + HireArr[index].type + "_" + HireArr[index].pos)

                        CmdArr = []
                        await sendMsg(10043, {
                            "type": HireArr[index].type,
                            "pos": HireArr[index].pos,
                            "targetUid": parseInt(SelfUid)
                        })
                        let goalPet
                        //取出雇佣目标精灵信息
                        CmdArr.forEach(item => {
                            if (parseInt(Object.keys(item)[0]) == 10043) {
                                goalPet = JSON.parse(item["10043"]).pet
                            }
                        })

                        console.log({
                            "levelId": 36,
                            "hirePetList": newTeamList,
                            "attachBattleSkill": [
                                {
                                    "petId": goalPet.petId,
                                    "level": goalPet.level,
                                    "skillList": goalPet.skills,
                                    "getTime": HireArr[index].getTime,
                                    "otherUid": parseInt(SelfUid),
                                    "type": HireArr[index].type
                                }
                            ]
                        })
                        //开始进入草系关卡
                        await sendMsg(4881, {
                            "levelId": 1,
                            "hirePetList": newTeamList,
                            "attachBattleSkill": [
                                {
                                    "petId": goalPet.petId,
                                    "level": goalPet.level,
                                    "skillList": goalPet.skills,
                                    "getTime": HireArr[index].getTime,
                                    "otherUid": parseInt(SelfUid),
                                    "type": HireArr[index].type
                                }
                            ]
                        })

                        await sendMsg(1042, {
                            "groupId": "",
                            "battleType": 0
                        })

                        await sendMsg(1045, {
                            "data": null,
                            "groupId": "",
                            "opType": 5
                        });
                        CmdArr = []

                        await sendMsg(1057, {
                            "groupId": "",
                        });
                        CmdArr = []

                        await sendMsg(1045, {
                            opType: 1,
                            data: {
                                skillID: nowSkillId,
                            },
                            groupId: "",
                        });
                        CmdArr = []
                        writeLog("本次雇佣完毕")
                        console.log("打完了！")
                        await wait(100)
                        break
                    }

                }
                if (doneGet == 0) {
                    writeLog("雇佣完毕！！")
                    return
                }
            }
        };
        buttonDiv1.appendChild(hire);

        var collection = document.createElement("button");
        collection.innerHTML = "采集";
        collection.style.margin = "4px";
        collection.style.width = "45px";
        collection.style.height = "30px";
        collection.onclick = async function () {
            await getResource()
        };
        buttonDiv1.appendChild(collection);

        frame.appendChild(buttonDiv1)

        let buttonDiv2 = document.createElement("div");
        buttonDiv2.style.display = 'flex'
        buttonDiv2.style.alignItems = 'center'
        buttonDiv2.style.justifyContent = 'space-evenly'
        buttonDiv2.style.margin = '10px 0px'

        var roulette = document.createElement("button");
        roulette.innerHTML = "轮盘";
        roulette.style.margin = "4px";
        roulette.style.width = "45px";
        roulette.style.height = "30px";
        roulette.onclick = async function () {
            await goPrize()
        };
        buttonDiv2.appendChild(roulette);

        var seize = document.createElement("button");
        seize.innerHTML = "捕捉";
        seize.style.margin = "4px";
        seize.style.width = "45px";
        seize.style.height = "30px";
        seize.onclick = async function () {
            if (rewrite == 0) {
                showToast("请先开启监听！")
                return
            }
            catchCount = 0
            if (isNaN(getFrequency())) {
                showToast("请输入捕捉次数！！")
                return
            }
            if (isNaN(getRound())) {
                showToast("请输入捕捉回合！！")
                return
            }
            while (1) {
                await catchPet()
                if (catchCount >= getFrequency()) {
                    writeLog("捕捉结束")
                    break
                }
            }
        };
        buttonDiv2.appendChild(seize);

        var pope = document.createElement("button");
        pope.innerHTML = "教皇";
        pope.style.margin = "4px";
        pope.style.width = "45px";
        pope.style.height = "30px";
        pope.onclick = async function () {
            if (rewrite == 0) {
                showToast("请先开启监听！宝贝")
                return
            }
            await battleF()
        };
        buttonDiv2.appendChild(pope);

        var ladder = document.createElement("button");
        ladder.innerHTML = "阶梯";
        ladder.style.margin = "4px";
        ladder.style.width = "45px";
        ladder.style.height = "30px";
        ladder.onclick = async function () {
            if (rewrite == 0) {
                showToast("请先开启监听！宝贝")
                return
            }
            await ptbattleF()
        };
        buttonDiv2.appendChild(ladder);

        var actionPVP = document.createElement("button");
        actionPVP.innerHTML = "PVP";
        actionPVP.style.margin = "4px";
        actionPVP.style.width = "45px";
        actionPVP.style.height = "30px";
        actionPVP.onclick = async function () {
            if (rewrite == 0) {
                showToast("请先开启监听！宝贝")
                return
            }
            let PVP = getSelectedOptionsPVP()
            if (PVP === "dianfengjingji") {
                await dianfeng("jingji")
            }
            if (PVP === "dianfengkuangye") {
                await dianfeng("kuangye")
            }
            if (PVP === "luandou") {
                await luandou()
            }
            if (PVP === "jingji") {
                await jingji()
            }
        };
        buttonDiv2.appendChild(actionPVP);
        frame.appendChild(buttonDiv2)

        let arenaDiv = document.createElement("div");
        arenaDiv.style.display = 'flex'
        arenaDiv.style.alignItems = 'center'
        arenaDiv.style.justifyContent = 'space-evenly'
        arenaDiv.style.margin = '10px 0px'

        let arenaSpen = document.createElement('spen');
        let arenaLabel = document.createElement('label');
        arenaLabel.innerHTML = '竞技场：';
        arenaLabel.style.fontSize = "14px";
        arenaSpen.appendChild(arenaLabel)

        let arenaSelect = document.createElement('select')
        arenaSelect.setAttribute('id', 'arenaSelectId')
        arenaSelect.style.border = '1px solid #ccc'
        arenaSelect.style.borderRadius = '5px'
        arenaSelect.style.fontSize = '14px'
        let arenaOption1 = document.createElement('option')
        arenaOption1.value = 'luandou'
        arenaOption1.text = '大乱斗'
        let arenaOption2 = document.createElement('option')
        arenaOption2.value = 'dianfengjingji'
        arenaOption2.text = '巅峰竞技'
        let arenaOption3 = document.createElement('option')
        arenaOption3.value = 'dianfengkuangye'
        arenaOption3.text = '巅峰狂野'
        let arenaOption4 = document.createElement('option')
        arenaOption4.value = 'jingji'
        arenaOption4.text = '竞技联赛'
        arenaSelect.appendChild(arenaOption1)
        arenaSelect.appendChild(arenaOption2)
        arenaSelect.appendChild(arenaOption3)
        arenaSelect.appendChild(arenaOption4)
        arenaSpen.appendChild(arenaSelect)
        arenaDiv.appendChild(arenaSpen)
        frame.appendChild(arenaDiv)

        let userSpen = document.createElement('spen');
        let userLabel = document.createElement('label');
        userLabel.innerHTML = 'UID：';
        userLabel.style.fontSize = "14px";
        var userInput = document.createElement("input");
        userInput.id = 'userId';
        userInput.placeholder = "雇佣UID"
        userInput.style.width = "70px"
        userInput.style.height = "14px"
        userSpen.appendChild(userLabel);
        userSpen.appendChild(userInput);
        arenaDiv.appendChild(userSpen);

        let enableDiv = document.createElement("div");
        enableDiv.style.display = 'flex'
        enableDiv.style.alignItems = 'center'
        enableDiv.style.justifyContent = 'flex-end'
        enableDiv.style.margin = '10px 0px'

        var enable = document.createElement("button");
        enable.innerHTML = "开启";
        enable.style.margin = "4px 5px 4px 4px";
        enable.style.width = "45px";
        enable.style.height = "30px";
        enable.onclick = function () {
            if (rewrite == 0) {
                try {
                    var userI = document.querySelector("iframe").contentWindow.UserManager.getInstance()
                } catch (e) {
                    var userI = UserManager.getInstance()
                }
                if (userI.userInfo == undefined) {
                    showToast("请先登入游戏再点击开启监听！！")
                    return
                }
                rewrite = 1
                fixMsg()
                showToast("顺利开启监听")
                if (produceLogPanel == 0) {
                    produceLogPanel = 1
                    produceLog()
                }
                enable.innerHTML = "关闭";
            } else if (rewrite == 1) {
                rewrite = 0
                backMSg()
                showToast("顺利关闭，内存得到部分释放")
                enable.innerHTML = "开启";
            }
        };
        enableDiv.appendChild(enable);
        frame.appendChild(enableDiv);

        // 创建一个文本框用于输出日志
        var logTextArea = document.createElement("textarea");
        logTextArea.id = 'logId';
        logTextArea.style.resize = 'none';
        logTextArea.readOnly = 'readOnly';
        logTextArea.style.display = "block";
        logTextArea.style.width = "94%";
        logTextArea.style.height = "70px";
        logTextArea.style.margin = "10px auto";
        logTextArea.scrollTop = logTextArea.scrollHeight;
        logTextArea.placeholder = "执行信息输出"
        frame.appendChild(logTextArea);

        //缩放按钮框架所在位置
        var zoomFrame = document.createElement("div");
        zoomFrame.style.position = "fixed";
        zoomFrame.style.left = "20px";
        zoomFrame.style.top = "90%";
        zoomFrame.style.zIndex = 999996;
        zoomFrame.style.height = "20px";

        // 创建一个缩放按钮
        var zoom = document.createElement("button");
        zoom.innerHTML = "缩";
        zoom.style.display = "block";
        zoom.style.borderRadius = "5px";
        zoom.style.border = "none";
        zoom.style.textDecoration = "none";
        zoom.style.transition = "all 0.3s ease";
        zoom.style.backgroundImage = "linear-gradient(to right, red, orange)";
        zoom.style.color = "white";
        // 在点击按钮时输出日志到文本框中
        zoom.onclick = function () {
            if (zoom.innerHTML == "缩") {
                zoom.innerHTML = "展"
                document.getElementById("cardPage").style.display = "none"
            } else {
                zoom.innerHTML = "缩"
                document.getElementById("cardPage").style.display = "block"
            }
        };
        zoomFrame.appendChild(zoom)

        setTimeout(() => {
            // 将 frame 添加到页面中
            let bdTag = document.getElementsByTagName("html")[0]
            bdTag.appendChild(zoomFrame);
            bdTag.appendChild(frame);
        }, 500)
        // 创建 MutationObserver 实例
        const observer1 = new MutationObserver((mutationsList) => {
            // 监听到内容变化时的回调函数
            logTextArea.scrollTop = logTextArea.scrollHeight;
        });

        // 配置 MutationObserver 监听的内容变化类型
        const config = { childList: true, subtree: true };

        // 开始监听 logTextArea 内容的变化
        if (logTextArea) {
            observer1.observe(logTextArea, config);
        } else {
            console.error("未监听到内容");
        }

        function produceLog() {
            try {
                tttt = new WatchChatList;
                tttt.skinName = "WatchChatListSkin";
                tttt.strMsg = ""
                tttt.y = 100;
                RES.loadConfig("resource/ui/battle.json", "resource/ui/").then(() => {
                    MFC.rootLayer.addChild(tttt)
                    tttt.$doRemoveChild(0)
                    tttt.$doRemoveChild(3)
                    tttt.$doRemoveChild(2)
                    tttt.$doRemoveChild(0)
                    tttt.$doRemoveChild(1)
                    tttt.$doRemoveChild(2)
                })
            } catch (e) {
                let WatchChatList = document.querySelector("iframe").contentWindow.WatchChatList
                tttt = new WatchChatList;
                tttt.skinName = "WatchChatListSkin";
                tttt.strMsg = ""
                tttt.y = 100;
                document.querySelector("iframe").contentWindow.RES.loadConfig("resource/ui/battle.json", "resource/ui/").then(() => {
                    document.querySelector("iframe").contentWindow.MFC.rootLayer.addChild(tttt)
                    tttt.$doRemoveChild(0)
                    tttt.$doRemoveChild(3)
                    tttt.$doRemoveChild(2)
                    tttt.$doRemoveChild(0)
                    tttt.$doRemoveChild(1)
                    tttt.$doRemoveChild(2)
                })
            }

        }
        function newLogOutput() {
            logTextArea.scrollTop = logTextArea.scrollHeight;
        }
        function writeLog(logStr) {
            logTextArea.value += logStr + "\n";
            newLogOutput();
            //第二代版本
            // try {
            //     tttt.strMsg = "<font color='#bbff00'>[护肝助手]</font><font color='#FFFFFF'>" + logStr + "</font>\n" + tttt.strMsg
            //     tttt.txtMsg.textFlow = (new egret.HtmlTextParser).parser(tttt.strMsg)
            // } catch (e) {
            //     tttt.strMsg = "<font color='#bbff00'>[护肝助手]</font><font color='#FFFFFF'>" + logStr + "</font>\n" + tttt.strMsg
            //     let TextParser = document.querySelector("iframe").contentWindow.egret.HtmlTextParser
            //     tttt.txtMsg.textFlow = (new TextParser).parser(tttt.strMsg)
            // }
        }

        async function fightQiu() {
            for (let index = 1; index <= 120; index++) {
                var FirgetTime
                var Pet
                try {
                    FirgetTime = document.querySelector("iframe").contentWindow.UserManager.getInstance().userInfo.defaultTeam[0]
                    Pet = document.querySelector("iframe").contentWindow.PetManager.getInstance().getPetInfoByGetTime(FirgetTime)
                } catch (e) {
                    FirgetTime = UserManager.getInstance().userInfo.defaultTeam[0]
                    Pet = PetManager.getInstance().getPetInfoByGetTime(FirgetTime)
                }

                writeLog(Pet.nick + "进入战斗")
                //17  进入战斗
                await sendMsg(1172, {
                    "levelId": 2,
                    "battleType": 3
                })
                while (1) {
                    if (bossStatus == true) {
                        bossStatus = false
                        break
                    }
                    await wait(100)
                }
                await sendSkillToSuccess(Pet.skills[0])
                writeLog("第" + index + "战斗顺利!")
            }
        }

        async function sendSkillToSuccess(nowSkillId) {
            await sendMsg(1042, {
                "groupId": "",
                "battleType": 0
            })
            await wait(100)

            await sendMsg(1045, {
                "opType": 5,
                "data": null,
                "groupId": ""
            })
            doneRound = false
            let CountBattle = 0
            while (1) {
                await wait(100)
                await sendMsg(1057, {
                    "groupId": ""
                })
                CountBattle++
                writeLog("释放第" + CountBattle + "次技能")
                await sendMsg(1045, {
                    "opType": 1,
                    "data": {
                        "skillID": nowSkillId
                    },
                    "groupId": ""
                })

                let oldTime = new Date().getTime()
                while (1) {
                    if ((new Date().getTime() - oldTime) / 1000 < 2) {
                        if (doneRound == true) {
                            doneRound = false
                            await wait(50)
                            return
                        } else {
                            await wait(50)
                        }
                    } else {
                        break
                    }
                }

                await wait(50)
            }

        }

        function showToast(txtMsg) {
            try {
                document.querySelector("iframe").contentWindow.MFC.bubbleAlert.showAlert(txtMsg)
            } catch (e) {
                MFC.bubbleAlert.showAlert(txtMsg)
            }

        }

        function showNotice(txtMsg) {
            try {
                document.querySelector("iframe").contentWindow.MFC.alert.showSimpleTxt(txtMsg)   //普通提示
            } catch (e) {
                MFC.alert.showSimpleTxt(txtMsg)   //普通提示
            }
        }

        async function getObjs(mapId, viewId, levelId) {
            await sendMsg(279, {})
            CmdArr = []

            await sendMsg(4354, { mapId: mapId, viewId: viewId })
            CmdArr = []

            await sendMsg(1172, {
                "levelId": levelId,
                "battleType": 3
            });
            CmdArr = []

            await sendMsg(1045, {
                "data": "",
                "groupId": "",
                "battleType": 5
            });
            CmdArr = []

            await sendMsg(1057, {
                "groupId": "",
            });
            CmdArr = []

            await sendMsg(1045, {
                opType: 1,
                data: {
                    skillID: skillID,
                },
                groupId: "",
            });
            CmdArr = []

            console.log("打完了！")
        }

        function sendMsg(nowCmd, nowBody) {
            return new Promise((resolve) => {
                if (document.querySelector("iframe").contentWindow.GlobalSocket == undefined) {
                    GlobalSocket.PROTOCOL_SOCKET.send(
                        nowCmd,
                        nowBody
                    );
                } else {
                    document.querySelector("iframe").contentWindow.GlobalSocket.PROTOCOL_SOCKET.send(
                        nowCmd,
                        nowBody
                    );
                }

                console.log({ "指令": nowCmd, "发送体": nowBody });
                async function checkCmd() {
                    while (true) {
                        await new Promise((resolve) => setTimeout(resolve, 1));

                        let keysArr = []
                        CmdArr.forEach(item => {
                            keysArr.push(parseInt(Object.keys(item)[0]))
                        })
                        if (keysArr.indexOf(nowCmd) != -1) {
                            console.info("接收到了信息！" + nowCmd)
                            resolve();
                            break;
                        }
                    }
                }

                checkCmd().then(resolve);
            });
        }

        function getSelectedOptionsPVP() {
            var selectElement = document.getElementById('arenaSelectId');
            var selectedValue = selectElement.options[selectElement.selectedIndex].value;
            return selectedValue;
        }

        function getSelectedOptions() {
            let selectElement = document.getElementById('capsuleSelectId');
            let selectedValue = selectElement.options[selectElement.selectedIndex].value;
            return selectedValue;
        }

        function getFrequency() {
            var frequency = document.getElementById('frequency');
            return frequency.value;
        }

        function getRound() {
            var round = document.getElementById('round');
            return round.value;
        }

        function getRandomIndex(array) {
            var randomIndex = Math.floor(Math.random() * array.length);
            return randomIndex;
        }

        //捕捉
        async function catchPet() {
            let opt = getSelectedOptions()
            round = getRound()
            try {
                var cap = document.querySelector("iframe").contentWindow.ItemManager.getInstance().getItemNumById(opt)
            } catch (e) {
                var cap = ItemManager.getInstance().getItemNumById(opt)
            }
            let nowStr = opt == "4001" ? "普通" : opt == "4002" ? "中级" : opt == "4003" ? "高级" : "";
            writeLog(`目前${nowStr}胶囊剩余数量:` + cap);
            try {
                let randomIndex = getRandomIndex(document.querySelector("iframe").contentWindow.MFC.mapManager._bossManager.bossDataList)
                var levelId = document.querySelector("iframe").contentWindow.MFC.mapManager._bossManager.bossDataList[randomIndex].id
            } catch (e) {
                let randomIndex = getRandomIndex(MFC.mapManager._bossManager.bossDataList)
                var levelId = MFC.mapManager._bossManager.bossDataList[randomIndex].id
            }
            await sendMsg(1172, {
                "levelId": levelId,
                "battleType": 3
            })
            while (1) {
                if (bossStatus == true) {
                    bossStatus = false
                    break
                }
                await wait(100)
            }

            //首发技能
            var Pet
            var FirgetTime
            try {
                FirgetTime = document.querySelector("iframe").contentWindow.UserManager.getInstance().userInfo.defaultTeam[0]
                Pet = document.querySelector("iframe").contentWindow.PetManager.getInstance().getPetInfoByGetTime(FirgetTime)
            } catch (e) {
                FirgetTime = UserManager.getInstance().userInfo.defaultTeam[0]
                Pet = PetManager.getInstance().getPetInfoByGetTime(FirgetTime)
            }
            await sendSkillAndCatch(Pet.skills[0], parseInt(opt))
        }

        async function sendSkillAndCatch(nowSkillId, capID) {
            await sendMsg(1042, {
                "groupId": "",
                "battleType": 0
            })
            await wait(100)
            await sendMsg(1045, {
                "opType": 5,
                "data": null,
                "groupId": ""
            })
            await wait(100)
            while (1) {
                if (nextRound == true) {
                    console.log("$$$$$$$$$$$$$$本回合结束$$$$$$$$$$$$$$")
                    writeLog("顺利进入对局！")
                    nextRound = false
                    break
                } else {
                    await wait(50)
                }
            }
            await wait(100)

            while (1) {
                await sendMsg(1057, {
                    "groupId": ""
                })

                await sendMsg(1045, {
                    "opType": 1,
                    "data": {
                        "skillID": nowSkillId
                    },
                    "groupId": ""
                })

                var haveHp = PetMsgDetail.result.playerInfos[1].petInfos[0].crtHp
                if (haveHp >= 500) {
                    writeLog("野怪开始HP异常：" + haveHp)
                    return
                } else {
                    writeLog("野怪开始HP：" + haveHp)
                }

                while (1) {
                    if (nextRound == true) {
                        console.log("$$$$$$$$$$$$$$本回合结束$$$$$$$$$$$$$$")
                        writeLog("继续释放技能！")
                        nextRound = false
                        break
                    } else {
                        await wait(50)
                    }
                }
                //等待1s  等待288结算的出现
                let oldTime = new Date().getTime()
                while (1) {
                    if ((new Date().getTime() - oldTime) / 1000 < 2) {
                        if (doneRound == true) {
                            console.log("##############战斗结束##############")
                            doneRound = false
                            await wait(50)
                            catchCount++
                            return
                        } else {
                            await wait(50)
                        }
                    } else {
                        break
                    }
                }

                if (haveHp <= 1) {
                    writeLog("野怪剩余HP：" + haveHp)
                    writeLog("开始捕捉！")
                    await wait(1000)
                    await sendMsg(1057, {
                        "groupId": ""
                    })
                    await wait(1000)
                    break
                }
            }
            let useC = 0
            changePet = ""
            while (1) {
                if (useC >= round) {
                    writeLog(round + "回合还没捕捉到，跑路了")
                    await sendMsg(8201, {})
                    await sendMsg(8209, {})
                    //逃跑
                    await sendMsg(303, {})
                    return
                }

                useC++
                writeLog("野怪剩余HP：" + haveHp)
                writeLog("丢出第" + useC + "次胶囊捕捉~")
                await sendMsg(1045, {
                    "opType": 3,
                    "data": {
                        "itemID": capID
                    },
                    "groupId": ""
                })

                await wait(200)
                while (1) {
                    if (nextRound == true) {
                        console.log("$$$$$$$$$$$$$$捕捉，本回合结束$$$$$$$$$$$$$$")
                        nextRound = false
                        break
                    } else {
                        await wait(100)
                        console.log("等待捕捉回合结束")
                    }
                }
                while (1) {
                    if (捕捉情况 != "") {
                        if (JSON.stringify(捕捉情况).indexOf("getTime") != -1) {
                            await wait(2000)
                            break
                        } else {
                            writeLog("捕捉失败")
                            await wait(1000)
                            break
                        }
                    } else {
                        await wait(1000)
                    }
                }
                捕捉情况 = ""

                //等待1s  等待288结算的出现
                let oldTime = new Date().getTime()
                while (1) {
                    if ((new Date().getTime() - oldTime) / 1000 < 2) {
                        if (doneRound == true) {
                            console.log("##############战斗结束##############")
                            doneRound = false
                            await wait(50)
                            catchCount++
                            return
                        } else {
                            await wait(50)
                        }
                    } else {
                        break
                    }
                }

                await wait(200)
                await sendMsg(1057, {
                    "groupId": ""
                })
                await wait(200)
            }
        }

        async function ptbattleF() {
            if (rewrite == 0) {
                showToast("请先开启监听！宝贝")
                return
            }
            showNotice("1.艾尔伊洛带幻化利刃增幅技能放一号位\n2.蒙多带光闪击增幅技能放二号位\n3.奥斯卡带圣灵击放三号位")
            //首次读取层数
            await sendMsg(1184,
                {}
            )
            while (1) {
                await wait(100)
                await sendMsg(1184,
                    {}
                )
                writeLog("当前层数:" + (parseInt(ptfloorContent.fragments.split("_")[1]) - 11))
                if (parseInt(ptfloorContent.fragments.split("_")[1]) >= 42) {
                    writeLog("顺利通关！，脚本结束")
                    await wait(200)
                    break
                }
                if (parseInt(ptfloorContent.fragments.split("_")[1]) < 22) {
                    await sendMsg(1184,
                        {}
                    )
                    writeLog("当前层数:" + ptfloorContent.fragments.split("_")[1])
                    await sendMsg(1185,
                        {
                            "idList": [0]
                        })
                    while (1) {
                        if (bossStatus == true) {
                            console.log("顺利加载战斗资源")
                            bossStatus = false
                            break
                        } else {
                            await wait(50)
                        }
                    }
                    await sendMsg(1042, {
                        "groupId": "",
                        "battleType": 0
                    })
                    await sendMsg(1045, {
                        "opType": 5,
                        "data": null,
                        "groupId": ""
                    })
                    await sendMsg(1057, {
                        "groupId": "",
                    });
                    writeLog(`释放幻化利刃`)
                    await sendMsg(1045, {
                        "opType": 1,
                        "data": {
                            "skillID": 100377
                            //10864
                            //100377
                        },
                        "groupId": ""
                    })
                    await wait(100)
                    await sendMsg(8201, {})
                    await sendMsg(8209, {})
                    //逃跑
                    await sendMsg(303, {})
                    await wait(50)
                    //顺利释放一次
                    console.log("顺利释放一次")
                }
                if (parseInt(ptfloorContent.fragments.split("_")[1]) >= 22) {
                    var Ha = ""
                    if (Buff == true) {
                        Ha = true

                    }
                    if (Ha == true) {
                        writeLog("重生逃跑")
                        await sendMsg(1185,
                            {
                                "idList": [2]
                            })
                        while (1) {
                            if (bossStatus == true) {
                                console.log("顺利加载战斗资源")
                                bossStatus = false
                                break
                            } else {
                                await wait(50)
                            }
                        }
                        await sendMsg(1042, {
                            "groupId": "",
                            "battleType": 0
                        })
                        await sendMsg(1045, {
                            "opType": 5,
                            "data": null,
                            "groupId": ""
                        })
                        await sendMsg(1057, {
                            "groupId": "",
                        })
                        writeLog(`释放圣灵击`)
                        await sendMsg(1045, {
                            "opType": 1,
                            "data": {
                                "skillID": 14861
                                //100436
                                //14861
                            },
                            "groupId": ""
                        })
                        await sendMsg(8201, {})
                        await sendMsg(8209, {})
                        //逃跑
                        await sendMsg(303, {})
                        await wait(50)
                        Ha = ""
                        //顺利释放一次
                        console.log("顺利释放一次")
                    }
                    else {
                        await sendMsg(1184,
                            {}
                        )
                        await sendMsg(1185,
                            {
                                "idList": [1]
                            })
                        while (1) {
                            if (bossStatus == true) {
                                console.log("顺利加载战斗资源")
                                bossStatus = false
                                break
                            } else {
                                await wait(50)
                            }
                        }
                        await sendMsg(1042, {
                            "groupId": "",
                            "battleType": 0
                        })
                        await sendMsg(1045, {
                            "opType": 5,
                            "data": null,
                            "groupId": ""
                        })
                        await sendMsg(1057, {
                            "groupId": "",
                        });
                        writeLog(`释放光闪击`)
                        await sendMsg(1045, {
                            "opType": 1,
                            "data": {
                                "skillID": 100023
                            },
                            "groupId": ""
                        })
                        await wait(100)
                        await sendMsg(8201, {})
                        await sendMsg(8209, {})
                        //逃跑
                        await sendMsg(303, {})
                        await wait(50)
                        //顺利释放一次
                        console.log("顺利释放一次")
                    }
                }
            }
        }

        async function battleF() {
            var doneKing = 0
            while (1) {
                await sendMsg(12496,
                    {
                        "type": 2,
                        "petList": [],
                        "idList": [],
                        "saveType": 0
                    }
                )
                while (1) {
                    if (floorContent != "") {
                        if (doneKing == 1 && (floorContent.fragments.split("_")[1] == 0)) {
                            writeLog("顺利击毙教皇！，脚本结束")
                            return
                        }
                        if (floorContent.fragments.split("_")[1] == "15") {
                            writeLog("当前层数:13,到教皇了")
                            doneKing = 1
                        } else {
                            writeLog("当前层数:" + floorContent.fragments.split("_")[1])
                        }
                        floorContent = ""
                        break
                    } else {
                        await wait(200)
                    }
                }
                floorContent = ""
                if (doneKing == 0) {
                    await sendMsg(12496,
                        {
                            "type": 3,
                            "petList": [],
                            "idList": [
                                0
                            ],
                            "saveType": 0
                        }
                    )
                } else {
                    await sendMsg(12496,
                        {
                            "type": 3,
                            "petList": [],
                            "idList": [
                                1
                            ],
                            "saveType": 0
                        }
                    )
                }

                writeLog("开始进入战斗")
                while (1) {
                    if (bossStatus == true) {
                        console.log("顺利加载战斗资源")
                        bossStatus = false
                        break
                    } else {
                        await wait(50)
                    }
                }

                await sendMsg(1042, {
                    "groupId": "",
                    "battleType": 0
                })

                await sendMsg(1045, {
                    "opType": 5,
                    "data": null,
                    "groupId": ""
                })
                await sendMsg(1057, {
                    "groupId": "",
                });

                if (doneKing == 0) {
                    writeLog(`释放蒙多光闪击`)
                    await sendMsg(1045, {
                        "opType": 1,
                        "data": {
                            "skillID": 100023
                        },
                        "groupId": ""
                    })
                } else {
                    writeLog(`释放雷伊雷神天明闪`)
                    await sendMsg(1045, {
                        "opType": 1,
                        "data": {
                            "skillID": 10825
                        },
                        "groupId": ""
                    })
                }

                await wait(100)
                await sendMsg(8201, {})

                await sendMsg(8209, {})
                //逃跑
                await sendMsg(303, {})

                await wait(300)

                //顺利释放一次
                console.log("顺利释放一次")
            }
        }

        async function jingji() {
            let PvpC = 0
            while (1) {
                while (1) {
                    await wait(100)
                    var allTouchs = getTouchs("_source", "arena_img_go_png")
                    if (allTouchs) {
                        touchBtn(allTouchs[2])
                        await wait(1000)
                        writeLog("前往竞技")
                    }
                    var allTouchs = getTouchs("_source", "arena_06_png")
                    if (allTouchs) {
                        //到达匹配界面
                        writeLog("到达竞技界面")
                        break
                    } else {
                        try {
                            document.querySelector("iframe").contentWindow.MFC.moduleManager.openModule(249)
                        } catch (error) {
                            MFC.moduleManager.openModule(249)
                        }
                        await wait(300)
                    }
                    var allTouchs = getTouchs("_source", "arena_top_fight_img_btn_pipei_png")
                    if (allTouchs) {
                        var nowUis = await findUIs("_source", "arena_top_fight_img_close_png")
                        writeLog("关闭巅峰窗口")
                        touchBtn(nowUis[0])
                        await wait(300)
                    }
                    var allTouchs = getTouchs("_source", "arena_77_png")
                    if (allTouchs) {
                        var nowUis = await findUIs("_source", "close_button_nor_png")
                        writeLog("关闭乱斗窗口")
                        touchBtn(nowUis[0].$parent)
                        await wait(300)
                    }
                }
                writeLog("点击竞技匹配")
                await wait(800)
                var nowUis = await findUIs("_source", "arena_06_png")
                await wait(800)
                writeLog("响应竞技匹配")
                touchBtn(nowUis[0].$parent)

                var nowUis = await findUIs("_source", "toolbar_auto_battle_off_png")
                writeLog("开始自动战斗")
                await wait(800)
                touchBtn(nowUis[0])
                logicDoneRound = false
                while (1) {
                    await wait(200)
                    if (logicDoneRound) {
                        break
                    }
                    try {
                        if (roundContent.result.roundNum >= 10) {
                            writeLog("到达十回合 发起投降")
                            //! !!发起投降
                            try {
                                document.querySelector("iframe").contentWindow.MFC.battleManager.surrenderPvp({
                                    "type": 10,
                                    "cmd": null,
                                    "mapID": 1001
                                })
                            } catch (e) {
                                MFC.battleManager.surrenderPvp({
                                    "type": 10,
                                    "cmd": null,
                                    "mapID": 1001
                                })
                            }
                            break
                        }
                    } catch (e) {
                    }
                }
                writeLog("竞技战斗结束")
                PvpC++
                writeLog("PVP 竞技: " + PvpC + "次")
                while (1) {
                    await wait(900)
                    let clickx1 = nnnn.touch.stage.$screen.stage.$stageWidth / 3
                    let clicky1 = nnnn.touch.stage.$screen.stage.$stageHeight / 3
                    nnnn.touch.onTouchBegin(clickx1, clicky1, 0); nnnn.touch.onTouchEnd(clickx1, clicky1, 0);
                    var allTouchs = getTouchs("_source", "button_yellow_up_100_png")
                    if (allTouchs) {
                        writeLog("升段提示,点击确认")
                        touchBtn(allTouchs[0])
                        await wait(1200)
                    }
                    var allTouchs = getTouchs("_source", "arena_06_png")
                    if (allTouchs) {
                        break
                    }
                }
            }
        }

        async function luandou() {
            let PvpC = 0
            while (1) {
                while (1) {
                    await wait(100)
                    var allTouchs = getTouchs("_source", "arena_img_go_png")
                    if (allTouchs) {
                        touchBtn(allTouchs[0])
                        await wait(1000)
                        writeLog("前往乱斗")
                    }
                    var allTouchs = getTouchs("_source", "arena_77_png")
                    if (allTouchs) {
                        //到达匹配界面
                        writeLog("到达乱斗界面")
                        break
                    } else {
                        try {
                            document.querySelector("iframe").contentWindow.MFC.moduleManager.openModule(249)
                        } catch (error) {
                            MFC.moduleManager.openModule(249)
                        }
                        await wait(300)
                    }
                    var allTouchs = getTouchs("_source", "arena_top_fight_img_btn_pipei_png")
                    if (allTouchs) {
                        var nowUis = await findUIs("_source", "arena_top_fight_img_close_png")
                        writeLog("关闭巅峰窗口")
                        touchBtn(nowUis[0])
                        await wait(300)
                    }
                    var allTouchs = getTouchs("_source", "arena_06_png")
                    if (allTouchs) {
                        var nowUis = await findUIs("_source", "close_button_nor_png")
                        writeLog("关闭竞技窗口")
                        touchBtn(nowUis[0].$parent)
                        await wait(300)
                    }
                }
                writeLog("点击乱斗匹配")
                await wait(800)
                var nowUis = await findUIs("_source", "arena_77_png")
                await wait(800)
                writeLog("响应乱斗匹配")
                touchBtn(nowUis[0].$parent)

                var nowUis = await findUIs("_source", "toolbar_auto_battle_off_png")
                writeLog("开始自动战斗")
                await wait(800)
                touchBtn(nowUis[0])
                logicDoneRound = false
                while (1) {
                    await wait(200)
                    if (logicDoneRound) {
                        break
                    }
                    try {
                        if (roundContent.result.roundNum >= 10) {
                            writeLog("到达十回合 发起投降")
                            //! !!发起投降
                            try {
                                document.querySelector("iframe").contentWindow.MFC.battleManager.surrenderPvp({
                                    "type": 10,
                                    "cmd": null,
                                    "mapID": 1001
                                })
                            } catch (e) {
                                MFC.battleManager.surrenderPvp({
                                    "type": 10,
                                    "cmd": null,
                                    "mapID": 1001
                                })
                            }
                            break
                        }
                    } catch (e) {
                    }
                }
                writeLog("大乱斗战斗结束")
                PvpC++
                writeLog("PVP 乱斗: " + PvpC + "次")
                while (1) {
                    await wait(900)
                    let clickx1 = nnnn.touch.stage.$screen.stage.$stageWidth / 3
                    let clicky1 = nnnn.touch.stage.$screen.stage.$stageHeight / 3
                    nnnn.touch.onTouchBegin(clickx1, clicky1, 0); nnnn.touch.onTouchEnd(clickx1, clicky1, 0);
                    var allTouchs = getTouchs("_source", "button_yellow_up_100_png")
                    if (allTouchs) {
                        writeLog("升段提示,点击确认")
                        touchBtn(allTouchs[0])
                        await wait(1200)
                    }
                    var allTouchs = getTouchs("_source", "arena_77_png")
                    if (allTouchs) {
                        break
                    }
                }

            }
        }

        async function dianfeng(name = "kuangye") {
            let PvpC = 0
            while (1) {
                while (1) {
                    await wait(100)
                    var allTouchs = getTouchs("_source", "arena_img_go_png")
                    if (allTouchs) {
                        touchBtn(allTouchs[1])
                        await wait(1000)
                        writeLog("前往巅峰")
                    }
                    var allTouchs = getTouchs("_source", "arena_top_fight_img_btn_pipei_png")
                    if (allTouchs) {
                        //到达匹配界面
                        writeLog("到达匹配界面")
                        break
                    } else {
                        try {
                            document.querySelector("iframe").contentWindow.MFC.moduleManager.openModule(249)
                        } catch (error) {
                            MFC.moduleManager.openModule(249)
                        }
                        await wait(300)
                    }
                    var allTouchs = getTouchs("_source", "arena_77_png")
                    if (allTouchs) {
                        var nowUis = await findUIs("_source", "close_button_nor_png")
                        showAllMsg("关闭乱斗窗口")
                        touchBtn(nowUis[0].$parent)
                        await wait(300)
                    }
                    var allTouchs = getTouchs("_source", "arena_06_png")
                    if (allTouchs) {
                        var nowUis = await findUIs("_source", "close_button_nor_png")
                        showAllMsg("关闭竞技窗口")
                        touchBtn(nowUis[0].$parent)
                        await wait(300)
                    }
                }

                if (name === "kuangye") {
                    var nowUis = await findUIs("_groupName", "rbg_top_switch")
                    writeLog("准备狂野模式")
                    touchBtn(nowUis[1])
                    await wait(800)
                } else if (name === "jingji") {
                    writeLog("准备竞技模式")
                }
                var nowUis = await findUIs("_source", "arena_top_fight_img_btn_pipei_png")
                await wait(800)
                touchBtn(nowUis[0])
                var nowUis = await findUIs("_source", "toolbar_auto_battle_off_png")
                writeLog("开始自动战斗")
                await wait(800)
                touchBtn(nowUis[0])
                writeLog("等待战斗结束")
                logicDoneRound = false
                while (1) {
                    await wait(200)
                    if (logicDoneRound) {
                        break
                    }
                    try {
                        if (roundContent.result.roundNum >= 10) {
                            writeLog("到达十回合 发起投降")
                            //! !!发起投降
                            try {
                                document.querySelector("iframe").contentWindow.MFC.battleManager.surrenderPvp({
                                    "type": 10,
                                    "cmd": null,
                                    "mapID": 1001
                                })
                            } catch (e) {
                                MFC.battleManager.surrenderPvp({
                                    "type": 10,
                                    "cmd": null,
                                    "mapID": 1001
                                })
                            }
                            break
                        }
                    } catch (e) {
                    }
                }
                writeLog("巅峰战斗结束")
                PvpC++
                writeLog("PVP 巅峰: " + PvpC + "次")
                await wait(1400)
                while (1) {
                    await wait(900)
                    let clickx1 = nnnn.touch.stage.$screen.stage.$stageWidth / 2
                    let clicky1 = nnnn.touch.stage.$screen.stage.$stageHeight / 2
                    nnnn.touch.onTouchBegin(clickx1, clicky1, 0); nnnn.touch.onTouchEnd(clickx1, clicky1, 0);
                    var allTouchs = getTouchs("_source", "button_yellow_up_100_png")
                    if (allTouchs) {
                        writeLog("升段提示,点击确认")
                        touchBtn(allTouchs[0])
                        await wait(1200)
                    }
                    var allTouchs = getTouchs("_source", "arena_top_fight_img_btn_pipei_png")
                    if (allTouchs) {
                        break
                    }
                }
            }
        }

        async function findUIs(attr, pngStr) {
            while (1) {
                await wait(100)
                var allTouchs = getTouchs(attr, pngStr)
                if (allTouchs) {
                    return allTouchs
                }
            }
        }

        function getTouchs(attr, btnName) {
            var uiObjects = [];
            function findUIObjects(container) {
                var children = container.$children;
                for (var i = 0; i < children.length; i++) {
                    var child = children[i];
                    try {
                        if (child instanceof document.querySelector("iframe").contentWindow.egret.DisplayObjectContainer) {
                            uiObjects.push(child);
                            findUIObjects(child);
                        } else {
                            // 这里可以根据需要判断其他类型的UI对象，将其加入uiObjects数组中
                        }
                    } catch (error) {
                        if (child instanceof egret.DisplayObjectContainer) {
                            uiObjects.push(child);
                            findUIObjects(child);
                        } else {
                            // 这里可以根据需要判断其他类型的UI对象，将其加入uiObjects数组中
                        }
                    }
                }
            }
            // 假设this.stage为舞台对象
            findUIObjects(sta);
            //!遍历所有 uiObjects
            var goalUis = []
            for (let index = 0; index < uiObjects.length; index++) {
                let element = uiObjects[index];
                if (element.$children) {
                    let nowC = element.$children
                    nowC.forEach((item) => {
                        try {
                            if (item[attr + ""]) {
                                if (item[attr + ""] == btnName) {
                                    goalUis.push(item)
                                }
                            }
                        } catch (error) {
                        }
                    })
                }
            }
            if (goalUis.length == 0) {
                return false
            }
            return goalUis
        }

        function touchBtn(goalUi) {
            try {
                document.querySelector("iframe").contentWindow.egret.TouchEvent.dispatchTouchEvent(goalUi, document.querySelector("iframe").contentWindow.egret.TouchEvent.TOUCH_BEGIN, !0, !0, 111, 111, 0, !0)
                document.querySelector("iframe").contentWindow.egret.TouchEvent.dispatchTouchEvent(goalUi, document.querySelector("iframe").contentWindow.egret.TouchEvent.TOUCH_TAP, !0, !0, 111, 111, 0, !0)
                document.querySelector("iframe").contentWindow.egret.TouchEvent.dispatchTouchEvent(goalUi, document.querySelector("iframe").contentWindow.egret.TouchEvent.TOUCH_END, !0, !0, 111, 111, 0, !0)
            } catch (e) {
                egret.TouchEvent.dispatchTouchEvent(goalUi, egret.TouchEvent.TOUCH_BEGIN, !0, !0, 111, 111, 0, !0)
                egret.TouchEvent.dispatchTouchEvent(goalUi, egret.TouchEvent.TOUCH_TAP, !0, !0, 111, 111, 0, !0)
                egret.TouchEvent.dispatchTouchEvent(goalUi, egret.TouchEvent.TOUCH_END, !0, !0, 111, 111, 0, !0)
            }
        }

        function fixMsg() {
            // 保存原函数
            var originalCreateMsg;
            try {
                var socketPrototype = document.querySelector("iframe").contentWindow.SocketSeqMsgs.prototype;
                if (socketPrototype.createMsg === undefined) {
                    originalCreateMsg = SocketSeqMsgs.prototype.createMsg;
                    socketPrototype = SocketSeqMsgs.prototype;
                } else {
                    originalCreateMsg = socketPrototype.createMsg;
                }
            } catch (e) {
                originalCreateMsg = SocketSeqMsgs.prototype.createMsg;
                socketPrototype = SocketSeqMsgs.prototype;
            }

            try {
                var originalGetLocation
                var WebTouchPrototype = document.querySelector("iframe").contentWindow.egret.web.WebTouchHandler.prototype
                originalGetLocation = WebTouchPrototype.getLocation;
                WebTouchPrototype.getLocation = function (nowT) {
                    window.globalThis.nnnn = this
                    // 在这里可以修改constructor函数的执行过程，加入你自己的逻辑
                    var result = originalGetLocation.call(this, nowT); // 调用原始的 getLocation 函数，并获取返回值
                    return result; // 返回原始 getLocation 函数的返回值
                };
            } catch (e) {
                var originalGetLocation
                var WebTouchPrototype = egret.web.WebTouchHandler.prototype
                originalGetLocation = WebTouchPrototype.getLocation;
                WebTouchPrototype.getLocation = function (nowT) {
                    window.global.nnnn = this
                    // 在这里可以修改constructor函数的执行过程，加入你自己的逻辑
                    var result = originalGetLocation.call(this, nowT); // 调用原始的 getLocation 函数，并获取返回值
                    return result; // 返回原始 getLocation 函数的返回值
                };
            }

            var originalCreateMsg;
            try {
                var originalTarget
                var sysTouchPrototype = document.querySelector("iframe").contentWindow.egret.sys.TouchHandler.prototype
                originalTarget = sysTouchPrototype.findTarget;
                sysTouchPrototype.findTarget = function (t, e) {
                    window.globalThis.sta = this.stage
                    // 在这里可以修改constructor函数的执行过程，加入你自己的逻辑
                    var result = originalTarget.call(this, t, e); // 调用原始的 getLocation 函数，并获取返回值
                    return result; // 返回原始 getLocation 函数的返回值
                };
            } catch (e) {
                var originalTarget
                var sysTouchPrototype = egret.sys.TouchHandler.prototype
                originalTarget = sysTouchPrototype.findTarget;
                sysTouchPrototype.findTarget = function (t, e) {
                    window.global.sta = this.stage
                    // 在这里可以修改constructor函数的执行过程，加入你自己的逻辑
                    var result = originalTarget.call(this, t, e); // 调用原始的 getLocation 函数，并获取返回值
                    return result; // 返回原始 getLocation 函数的返回值
                };
            }

            socketPrototype.createMsg = function (t, e) {
                originalCreateMsg.call(this, t, e);
                var s = this._tmpBytesArray[this._tmpBytesArray.length - 1];
                var raw = s.raw;
                var cmd = parseInt((s.header.cmd + "").trim());
                CmdArr.push({ [cmd]: raw });
                // console.log("=======");
                // console.log('接收cmd:', cmd);
                // console.log('raw:', raw);
                try {
                    if (cmd == 1056) {
                        roundContent = JSON.parse(raw);
                        console.log("本回合结束")
                        nextRound = true;
                        PetMsgDetail = JSON.parse(raw);
                        let result = JSON.parse(raw).result.result
                        // 0未结束战斗 1我方获胜 2对方获胜
                        battleResult = result
                        console.error("对战结果:" + battleResult)
                        if (result) {
                            logicDoneRound = true
                        } else {
                            logicDoneRound = false
                        }
                    }
                    if (cmd == 1049) {
                        console.log("顺利加载进入战斗！")
                        bossStatus = true;
                    }
                    if (raw.indexOf("defaultTeam") != -1) {
                        myTeam = JSON.parse(raw).value;
                        console.log(myTeam);
                        // writeLog("顺利获取精灵配置信息！")
                    }
                    if ((cmd == 1120) && (raw.indexOf("starMedal") != -1)) {
                        StartJson = JSON.parse(raw);
                    }

                    if (cmd == 12501) {
                        let arr = JSON.parse(raw).map
                        writeLog("蟠桃情况~")
                        arr.forEach(item => {
                            writeLog(item)
                        })
                    }

                    if (cmd == 12496 && (raw.indexOf("fragments") != -1)) {
                        floorContent = JSON.parse(raw);
                        if (raw.indexOf("10825") != -1) {
                            skillSecondId = 10825
                        }
                        if (raw.indexOf("100484") != -1) {
                            skillSecondId = 100484
                        }
                        if (raw.indexOf("12776") != -1) {
                            skillSecondId = 12776
                        }
                    }


                    if (cmd == 1056) {
                        const idValues = JSON.parse(raw).result.affects.map((item) => {
                            return item && item.id ? item.id : null;
                        });
                        const Number = 143;
                        if (idValues.includes(Number)) {
                            Buff = true;
                        }
                    }
                    if (cmd == 1184) {
                        ptfloorContent = JSON.parse(raw);
                        Buff = "";
                    }

                    if (cmd == 1044) {
                        捕捉ok = true;
                    }
                    if (cmd == 288) {
                        changePet = JSON.parse(raw);
                    }

                    if (cmd == 769 || cmd == 513) {
                        // if (JSON.parse(raw).subCmd == 1) {
                        // console.log(JSON.parse(raw))
                        捕捉情况 = JSON.parse(raw);
                        // }
                        if (JSON.parse(raw).subCmd == 1) {
                            writeLog("捕捉成功:" + JSON.parse(raw).pet.nick + " 天赋: " + JSON.parse(raw).pet.talent)
                        }
                    }
                    if (cmd == 1109) {
                        console.log("战斗结束")
                        doneRound = true;
                        doneBattleMsg = JSON.parse(raw);

                    }
                } catch (e) { }

                // console.log("=======");
            };

            // //重写图鉴监听方法
            // var PetView
            // if (document.querySelector("iframe").contentWindow.SocketSeqMsgs == undefined) {
            //     PetView = petIllustrated.PetIllustrated.prototype.updatePetAttrView;
            //     // 重写updatePetAttrView方法
            //     petIllustrated.PetIllustrated.prototype.updatePetAttrView = function (e) {
            //         console.log(e)
            //         // 执行原有的createMsg方法e
            //         PetView.call(this, e);

            //     }
            // } else {
            //     PetView = document.querySelector("iframe").contentWindow.petIllustrated.PetIllustrated.prototype.updatePetAttrView;
            //     // 重写updatePetAttrView方法
            //     document.querySelector("iframe").contentWindow.petIllustrated.PetIllustrated.prototype.updatePetAttrView = function (e) {
            //         console.log(e)
            //         // 执行原有的createMsg方法e
            //         PetView.call(this, e);

            //     }
            // }

        }

        function backMSg() {
            // 保存原函数
            if (document.querySelector("iframe").contentWindow.SocketSeqMsgs == undefined) {
                var originalCreateMsg = SocketSeqMsgs.prototype.createMsg;
                SocketSeqMsgs.prototype.createMsg = function (t, e) {
                    // 执行原有的createMsg方法
                    originalCreateMsg.call(this, t, e);
                }
            } else {
                var originalCreateMsg = document.querySelector("iframe").contentWindow.SocketSeqMsgs.prototype.createMsg;
                document.querySelector("iframe").contentWindow.SocketSeqMsgs.prototype.createMsg = function (t, e) {
                    // 执行原有的createMsg方法
                    originalCreateMsg.call(this, t, e);

                }
            }
        }

        function wait(ms) {
            return new Promise(resolve => setTimeout(() => resolve(), ms));
        };

        function getCountByItemId(itemID) {
            let count
            try {
                count = ItemManager.getInstance().getItemNumById(itemID);
            } catch (e) {
                count = document.querySelector("iframe").contentWindow.ItemManager.getInstance().getItemNumById(itemID);
            }
            return count
        }

        function checkPet(skillList) {
            for (let index = 0; index < skillList.length; index++) {
                if (skillList[index].id == 100023) {
                    skillStarId = "100023"
                    return
                }
                if (skillList[index].id == 11022) {
                    return
                }
            }
            skillStarId = skillList[0].id
        }

        //迷航
        async function starTrek() {
            if (rewrite == 0) {
                showToast("请先开启监听！宝贝")
                return
            }
            showNotice("如有不能正常运行。\n1.请确保魔焰和蒙多放到一号二号位置喔~~\n2.请确定魔焰猩猩是否带了绝命，蒙多是否带了光闪击\n3.请确保蒙多具有瞬杀特性\n4.只需要带这两只精灵即可")
            //首次读取技能
            await sendMsg(1120, {
                "type": 0
            })
            checkPet(StartJson.petList[0].useSkills)
            checkPet(StartJson.petList[1].useSkills)

            while (1) {
                await wait(100)
                await sendMsg(1120, {
                    "type": 0
                })
                writeLog(`迷航进度: 第${parseInt(StartJson.levelId) + 1}关卡`)
                if (parseInt(StartJson.levelId) >= 15) {
                    writeLog(`完成迷航，进行领取`)
                    await wait(200)
                    await sendMsg(1223, {})
                    break
                }
                if ((parseInt(StartJson.levelId) + 1) > 8) {
                    let skillList = StartJson.petList[0].useSkills
                    for (let index = 0; index < skillList.length; index++) {
                        if (skillList[index].id == 11022) {
                            writeLog(`首发为蒙多，继续！`)
                            await sendMsg(1122, {
                                "petList": [
                                    StartJson.petList[1].getTime,
                                    StartJson.petList[0].getTime,
                                    0,
                                    0,
                                    0,
                                    0
                                ],
                                "attachBattleSkill": []
                            })
                            await sendMsg(1120, {
                                "type": 0
                            })
                        }
                    }
                }

                //前8关卡
                if ((parseInt(StartJson.levelId) + 1) <= 8) {
                    let skillList = StartJson.petList[0].useSkills
                    for (let index = 0; index < skillList.length; index++) {
                        if (skillList[index].id == skillStarId) {
                            writeLog(`首发为魔焰，继续！`)
                            await sendMsg(1122, {
                                "petList": [
                                    StartJson.petList[1].getTime,
                                    StartJson.petList[0].getTime,
                                    0,
                                    0,
                                    0,
                                    0
                                ],
                                "attachBattleSkill": []
                            })
                            await sendMsg(1120, {
                                "type": 0
                            })
                        }
                    }
                }

                //2.进入迷航关卡
                await sendMsg(1121, {
                    "getTimeList": [
                        StartJson.petList[0].getTime,
                        StartJson.petList[1].getTime,
                        0,
                        0,
                        0,
                        0
                    ]
                })
                while (1) {
                    if (bossStatus == true) {
                        console.log("顺利加载战斗资源")
                        bossStatus = false
                        break
                    } else {
                        await wait(50)
                    }
                }

                await sendMsg(1042, {
                    "groupId": "",
                    "battleType": 0
                })

                await sendMsg(1045, {
                    "opType": 5,
                    "data": null,
                    "groupId": ""
                })
                await sendMsg(1057, {
                    "groupId": "",
                });

                if (parseInt(StartJson.levelId) + 1 <= 8) {
                    writeLog(`释放绝命火焰`)
                    await sendMsg(1045, {
                        "opType": 1,
                        "data": {
                            "skillID": 11022
                        },
                        "groupId": ""
                    })
                } else {
                    writeLog(`释放蒙多光闪击`)
                    await sendMsg(1045, {
                        "opType": 1,
                        "data": {
                            "skillID": skillStarId
                        },
                        "groupId": ""
                    })
                }
                await wait(100)

                await sendMsg(8201, {})

                await sendMsg(8209, {})
                //逃跑
                await sendMsg(303, {})

                await wait(50)

                //顺利释放一次
                console.log("顺利释放一次")
            }

        }

        //轮盘
        async function goPrize() {
            if (rewrite == 0) {
                showToast("请先开启监听！宝贝")
                return
            }

            let CountC = 0
            //双子阿尔法星     每次消耗1个 1个
            while (1) {
                count0 = getCountByItemId(100191);
                count1 = getCountByItemId(100193);
                if (count0 >= 1 && count1 >= 1) {
                    CountC++
                    writeLog("双子阿尔法星1级轮盘第" + CountC + "次")
                    await wait(200)
                    await sendMsg(8997, {
                        "levelId": 6,
                        "prizePool": 1
                    })
                } else {
                    writeLog("双子阿尔法星1级轮盘清空!")
                    break
                }
            }

            CountC = 0
            //暗影星轮盘     每次消耗 2个
            while (1) {
                count = getCountByItemId(100313);
                if (count >= 2) {
                    CountC++
                    writeLog("暗影星1级轮盘第" + CountC + "次")
                    await wait(200)
                    await sendMsg(8997, {
                        "levelId": 8,
                        "prizePool": 1
                    })
                } else {
                    writeLog("暗影星1级轮盘清空!")
                    break
                }
            }

            //皮皮星轮盘     每次消耗5个
            CountC = 0
            while (1) {
                var count = getCountByItemId(100014)  //获取物品id对应数量   光合能量
                if (count >= 5) {
                    CountC++
                    writeLog("皮皮星轮盘第" + CountC + "次")
                    await wait(200)
                    await sendMsg(8997, {
                        "levelId": 1,
                        "prizePool": 1
                    })
                } else {
                    writeLog("皮皮星轮盘清空!")
                    break
                }
            }

            CountC = 0
            //海洋星2级轮盘    每次消耗2个  和  1个    1个
            while (1) {
                var count0 = getCountByItemId(100015);    //甲烷
                var count1 = getCountByItemId(100016);;    //青晶石
                var count2 = getCountByItemId(100017);    //黑曜石
                if (count0 >= 2 && count1 >= 1 && count2 >= 1) {
                    CountC++
                    writeLog("海洋星2级轮盘第" + CountC + "次")
                    await wait(200)
                    await sendMsg(8997, {
                        "levelId": 2,
                        "prizePool": 2
                    })
                } else {
                    writeLog("海洋星2级轮盘清空!")
                    break
                }
            }

            CountC = 0
            //海洋星1级轮盘    每次消耗2个  和  1个
            while (1) {
                var count0 = getCountByItemId(100015);    //甲烷
                var count1 = getCountByItemId(100016);    //青晶石
                if (count0 >= 2 && count1 >= 1) {
                    CountC++
                    writeLog("海洋星1级轮盘第" + CountC + "次")
                    await wait(200)
                    await sendMsg(8997, {
                        "levelId": 2,
                        "prizePool": 1
                    })
                } else {
                    writeLog("海洋星1级轮盘清空!")
                    break
                }
            }

            CountC = 0
            //火山星1轮盘    每次消耗1个  和  2个
            while (1) {
                var count0 = getCountByItemId(100029);    //甲烷
                var count1 = getCountByItemId(100030);    //青晶石
                if (count0 >= 1 && count1 >= 2) {
                    CountC++
                    writeLog("火山星1级轮盘第" + CountC + "次")
                    await wait(200)
                    await sendMsg(8997, {
                        "levelId": 3,
                        "prizePool": 1
                    })
                } else {
                    writeLog("火山星1级轮盘清空!")
                    break
                }
            }

            CountC = 0
            //火山星2轮盘     每次消耗 1个
            while (1) {
                var count = getCountByItemId(100031);
                if (count >= 1) {
                    CountC++
                    writeLog("火山星2级轮盘第" + CountC + "次")
                    await wait(200)
                    await sendMsg(8997, {
                        "levelId": 3,
                        "prizePool": 2
                    })
                } else {
                    writeLog("火山星2级轮盘清空!")
                    break
                }
            }

            CountC = 0
            //云霄1轮盘     每次消耗2个
            while (1) {
                var count = getCountByItemId(100076);     //空气结晶
                if (count >= 2) {
                    CountC++
                    writeLog("云霄星1级轮盘第" + CountC + "次")
                    await wait(200)
                    await sendMsg(8997, {
                        "levelId": 5,
                        "prizePool": 1
                    })
                } else {
                    writeLog("云霄星1级轮盘清空!")
                    break
                }
            }

            CountC = 0
            //云霄2轮盘     每次消耗2个 1个
            while (1) {
                var count0 = getCountByItemId(100077);    //不息云壤
                var count1 = getCountByItemId(100078);   //幻影之羽
                if (count0 >= 2 && count1 >= 1) {
                    CountC++
                    writeLog("云霄星2级轮盘第" + CountC + "次")
                    await wait(200)
                    await sendMsg(8997, {
                        "levelId": 5,
                        "prizePool": 2
                    })
                } else {
                    writeLog("云霄星2级轮盘清空!")
                    break
                }
            }

            CountC = 0
            while (1) {
                count = getCountByItemId(100195);
                if (count >= 1) {
                    CountC++
                    writeLog("双子阿尔法星2级轮盘第" + CountC + "次")
                    await wait(200)
                    await sendMsg(8997, {
                        "levelId": 6,
                        "prizePool": 2
                    })
                } else {
                    writeLog("双子阿尔法星2级轮盘清空!")
                    break
                }
            }
            CountC = 0
            while (1) {
                count = getCountByItemId(100315);
                if (count >= 1) {
                    CountC++
                    writeLog("暗影星2级轮盘第" + CountC + "次")
                    await wait(200)
                    await sendMsg(8997, {
                        "levelId": 8,
                        "prizePool": 2
                    })
                } else {
                    writeLog("暗影星2级轮盘清空!")
                    break
                }
            }
        }

        async function getResource() {
            if (rewrite == 0) {
                showToast("请先开启监听！宝贝")
                return
            }
            for (let index = 0; index <= 4; index++) {
                await wait(200)
                await sendMsg(9147, { id: 1 })  //黄晶矿
            }
            for (let index = 0; index <= 4; index++) {
                await wait(200)
                await sendMsg(9147, { id: 2 })  //黄晶矿
            }
            for (let index = 0; index <= 4; index++) {
                await wait(200)
                await sendMsg(9147, { id: 3 })  //黄晶矿
            }
            writeLog("黄晶矿采集完成！！")
            for (let index = 0; index <= 9; index++) {
                await wait(200)
                await sendMsg(9147, { id: 34 }) //砂金石
            }
            writeLog("砂金石采集完成！！")
            for (let index = 0; index <= 1; index++) {
                await wait(200)
                await sendMsg(9147, { id: 4 })    //甲烷燃气
            }
            for (let index = 0; index <= 1; index++) {
                await wait(200)
                await sendMsg(9147, { id: 5 })    //甲烷燃气
            }
            for (let index = 0; index <= 1; index++) {
                await wait(200)
                await sendMsg(9147, { id: 6 })    //甲烷燃气
            }
            writeLog("甲烷燃气采集完成！！")
            for (let index = 0; index <= 2; index++) {
                await wait(200)
                await sendMsg(9147, { id: 7 })
            }
            writeLog("蘑菇结晶采集完成！！")
            for (let index = 0; index <= 0; index++) {
                await wait(200)
                await sendMsg(9147, { id: 8 })
            }
            writeLog("豆豆果实采集完成！！")
            for (let index = 0; index <= 0; index++) {
                await wait(200)
                await sendMsg(9147, { id: 9 })
            }
            writeLog("纳格晶体采集完成！！")
            for (let index = 0; index <= 1; index++) {
                await wait(200)
                await sendMsg(9147, { id: 10 })
            }
            writeLog("电能石采集完成！！")
        }
    </script>
</body>

</html>